<div class="card" *ngIf="isLoading">
  <h4 class="card-header">Loading...</h4>
  <div class="card-block text-xs-center">
    <i class="fa fa-spinner fa-spin fa-3x"></i>
  </div>
</div>
<div class="card" *ngIf="!isLoading">
  <h4 class="card-header">Current Plans ({{plans.length}})</h4>
  <button *ngIf="isShow" class="btn btn-sm btn-default" (click)="enableAdding()"><i class="fa fa-times"></i> Add Plan</button>
  <button *ngIf="isAdding" class="btn btn-sm btn-default" (click)="showall()"><i class="fa fa-times"></i> All Plan</button>
  <!--<div class="col-xs-2">
                <label class="label-control">Rows on page</label>
                <select class="form-control input-sm" [(ngModel)]="rowsOnPage">
                    <option [ngValue]="5">5</option>
                    <option [ngValue]="10">10</option>
                    <option [ngValue]="15">15</option>
                </select>
            </div>
            <div class="col-xs-4">
                <div class="row">
                    <label class="col-xs-12 label-control">Sort by</label>
                </div>
                <div class="col-xs-6">
                    <div class="row">
                        <select class="form-control input-sm" [(ngModel)]="sortBy">
                            <option ngValue="name">Name</option>
                            <option ngValue="email">Email</option>
                            <option ngValue="age">Age</option>
                            <option [ngValue]="sortByWordLength">City</option>
                        </select>
                    </div>
                </div>
                <div class="col-xs-6">
                    <div class="row">
                        <select class="form-control input-sm" [(ngModel)]="sortOrder">
                            <option ngValue="asc">Ascending</option>
                            <option ngValue="desc">Descending</option>
                            <option ngValue="badValue">Bad value</option>
                        </select>
                    </div>
                </div>
            </div>-->
  <div class="card-block" *ngIf="isShow">
      
    <table class="table table-striped" [mfData]="plans" #mf="mfDataTable"
                   [mfRowsOnPage]="rowsOnPage" [(mfSortBy)]="sortBy" [(mfSortOrder)]="sortOrder">
                <thead class="thead-default"  *ngIf="!isEditing">
                <tr>
                    <th style="width: 20%">
                        <mfDefaultSorter by="planName">PlanName</mfDefaultSorter>
                    </th>
                    <th style="width: 20%">
                        <mfDefaultSorter by="price">Price</mfDefaultSorter>
                    </th>
                    <th style="width: 20%">
                        <mfDefaultSorter by="timeDuration">Time Duration</mfDefaultSorter>
                    </th>
                    <th style="width: 20%">
                        <mfDefaultSorter by="status">Status</mfDefaultSorter>
                    </th>
                    <th style="width: 20%">Actions</th>
                </tr>
                <!--<tr>
                    <th colspan="5">
                        Filter by name:
                        <input class="form-control" [(ngModel)]="filterQuery"/>
                    </th>
                </tr>-->
                </thead>
                <tbody>
    
      <tbody *ngIf="plans.length === 0">
        <tr>
          <td colspan="6">There are no plans in the DB. Add a new plan above.</td>
        </tr>  
      </tbody>
      <tbody *ngIf="!isEditing">
        <tr *ngFor="let user of plans">
          <td>{{user.planName}}</td>
          <td>{{user.price}}</td>
          <td>{{user.timeDuration}}</td>
          <td>{{user.status}}</td>
          <td>
            <button class="btn btn-sm btn-warning" (click)="enableEditing(user)"><i class="fa fa-pencil"></i> Edit</button> 
            <button class="btn btn-sm btn-danger" (click)="deleteUser(user)"><i class="fa fa-trash"></i> Delete</button>
          </td>
        </tr>  
      </tbody>
      <tfoot>
    <tr>
        <td colspan="5">
            <mfBootstrapPaginator [rowsOnPageSet]="[5,10,25]"></mfBootstrapPaginator>
        </td>
    </tr>
    </tfoot>
    </table>
  </div>
</div>

<div class="card" *ngIf="isEditing">
    <div class="card-header">
    <strong>Update</strong>User Form
    </div>
    <div class="card-block">
    <form #form="ngForm" (ngSubmit)="form.form.valid && editPlan(user)" novalidate>
        <div class="form-group">
        <label for="planName">PlanName</label>
        <input class="form-control" type="text" name="planName" [(ngModel)]="user.planName" placeholder="PlanName" required>
        
        </div>
        <div class="form-group">
        <label for="Price">Price</label>
        <input class="form-control" type="text" name="price" [(ngModel)]="user.price" placeholder="Price" required>
        
        </div>
        <div class="form-group">
            <label for="TimeDuration">TimeDuration</label>
            <input class="form-control" type="text" name="timeDuration" [(ngModel)]="user.timeDuration" placeholder="TimeDuration" required>
        </div>
        <div class="form-group">
            <label for="Description">Description</label>
            <textarea class="form-control" [(ngModel)]="user.description" name="description" required #description="ngModel"></textarea>
        </div>
        <div class="form-group">
            <label for="status">Status</label>
            <input class="form-control" type="text" name="status" [(ngModel)]="user.status" placeholder="Status" required>
        </div>
        <div class="card-footer">
        <button type="submit" [disabled]="loading" class="btn btn-sm btn-primary"><i class="fa fa-floppy-o"></i> Save</button>
        <img *ngIf="loading" src="images/loading.gif" />
        <button class="btn btn-sm btn-danger" (click)="cancelEditing()"><i class="fa fa-ban"></i> Cancel</button>
        </div>
    </form>
    </div>
</div>

<div class="card" *ngIf="isAdding">
  <h4 class="card-header">Add new User</h4>
  <div class="card-block">
    <form  (ngSubmit)="f.form.valid && addPlan(user)" #f="ngForm" novalidate>
        <div class="form-group" [ngClass]="{ 'has-error': f.submitted && !planName.valid }">
            <label for="planName">Plan Name</label>
            <input type="text" class="form-control" name="planName" [(ngModel)]="user.planName" #planName="ngModel" required placeholder="PlanName"/>
            <div *ngIf="f.submitted && !planName.valid" class="help-block">Plan Name is required</div>
        </div>
        <div class="form-group" [ngClass]="{ 'has-error': f.submitted && !price.valid }">
            <label for="price">Price</label>
            <input type="text" class="form-control" name="price" [(ngModel)]="user.price" #price="ngModel" required placeholder="Price" />
            <div *ngIf="f.submitted && !price.valid" class="help-block">Price is required</div>
        </div>
        <div class="form-group" [ngClass]="{ 'has-error': f.submitted && !timeDuration.valid }">
            <label for="timeDuration">TimeDuration</label>
            <input type="text" class="form-control" name="timeDuration" [(ngModel)]="user.timeDuration" #timeDuration="ngModel" required placeholder="TimeDuration" />
            <div *ngIf="f.submitted && !timeDuration.valid" class="help-block">TimeDuration is required</div>
        </div>
        <div class="form-group" [ngClass]="{ 'has-error': f.submitted && !description.valid }">
            <label for="username">description</label>
            <input type="text" class="form-control" name="description" [(ngModel)]="user.description" #description="ngModel" required placeholder="description" />
            <div *ngIf="f.submitted && !description.valid" class="help-block">description is required</div>
        </div>
        <div class="form-group" [ngClass]="{ 'has-error': f.submitted && !status.valid }">
            <label for="status">status</label>
            <input type="status" class="form-control" name="status" [(ngModel)]="user.status" #status="ngModel" required placeholder="status" />
            <div *ngIf="f.submitted && !status.valid" class="help-block">status is required</div>
        </div>
        <div class="card-footer">
        <button type="submit" [disabled]="loading" class="btn btn-sm btn-primary"><i class="fa fa-floppy-o"></i> Save</button>
        <img *ngIf="loading" src="images/loading.gif" />
        <button class="btn btn-sm btn-danger" (click)="cancelAdding()"><i class="fa fa-ban"></i> Cancel</button>
        </div>
    </form>
  </div>
</div>